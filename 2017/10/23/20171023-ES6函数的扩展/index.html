<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="-ES," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="相比于ES5，ES6对函数也做了一些扩展，比如允许对函数参数设置默认值等">
<meta property="og:type" content="article">
<meta property="og:title" content="ES6函数的扩展">
<meta property="og:url" content="http://yy709593266.github.io/blog/2017/10/23/20171023-ES6函数的扩展/index.html">
<meta property="og:site_name" content="袁媛-仙女很忙">
<meta property="og:description" content="相比于ES5，ES6对函数也做了一些扩展，比如允许对函数参数设置默认值等">
<meta property="og:updated_time" content="2017-12-03T11:20:09.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ES6函数的扩展">
<meta name="twitter:description" content="相比于ES5，ES6对函数也做了一些扩展，比如允许对函数参数设置默认值等">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="http://yy709593266.github.io/blog/2017/10/23/20171023-ES6函数的扩展/"/>

  <title> ES6函数的扩展 | 袁媛-仙女很忙 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">袁媛-仙女很忙</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">仙女也要码砖不像话</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="#" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                ES6函数的扩展
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-10-23T22:49:47+08:00" content="2017-10-23">
              2017-10-23
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>相比于ES5，ES6对函数也做了一些扩展，比如允许对函数参数设置默认值等<a id="more"></a></p>
<p>1、<code>ES6</code>允许为函数的参数设置默认值，即直接写在参数定义的后面：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">function log(x, y = &apos;World&apos;) &#123;</div><div class="line">  console.log(x, y);</div><div class="line">&#125;</div><div class="line"></div><div class="line">log(&apos;Hello&apos;) // Hello World</div><div class="line">log(&apos;Hello&apos;, &apos;China&apos;) // Hello China</div><div class="line">log(&apos;Hello&apos;, &apos;&apos;) // Hello</div></pre></td></tr></table></figure></p>
<p>其中参数变量是默认声明的，所以不能再使用<code>let</code>或者<code>const</code>再次声明，否则会报错，所以一个函数也不能有相同的两个变量参数，这也就相当于重复声明（默认声明）了一个变量。另外，参数的默认值每次都是在调用的时候重新计算的，不是一直不变的：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">let x = 99;</div><div class="line">function foo(p = x + 1) &#123;</div><div class="line">  console.log(p);</div><div class="line">&#125;</div><div class="line"></div><div class="line">foo() // 100</div><div class="line"></div><div class="line">x = 100;</div><div class="line">foo() // 101</div></pre></td></tr></table></figure></p>
<p>2、参数默认值可以与解构赋值的默认值，结合起来使用<br>首先看下面一个例子：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">function foo(&#123;x, y = 5&#125;) &#123;</div><div class="line">  console.log(x, y);</div><div class="line">&#125;</div><div class="line"></div><div class="line">foo(&#123;&#125;) // undefined 5</div><div class="line">foo(&#123;x: 1&#125;) // 1 5</div><div class="line">foo(&#123;x: 1, y: 2&#125;) // 1 2</div><div class="line">foo() // TypeError: Cannot read property &apos;x&apos; of undefined</div></pre></td></tr></table></figure></p>
<p>最后一个调用之所以会报错是因为，只有当函数的参数是一个对象时，变量<code>x</code>和<code>y</code>才能通过对象的解析赋值生成值，就相当于我调用这个函数的时候传了参数，首先第一步就是参数的解析赋值，比如传进来的参数是空对象<code>{}</code>时，那么首先进行解析赋值操作，即<code>{x, y = 5} = {}</code>,解析赋值得到的结果就是<code>{x, y = 5}</code>，所以当传入的参数是空的时候，解析赋值出错自然就报错了。因此，通过提供函数参数的默认值就可以避免这种情况：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">function foo(&#123;x, y = 5&#125; = &#123;&#125;) &#123;</div><div class="line">  console.log(x, y);</div><div class="line">&#125;</div><div class="line"></div><div class="line">foo() // undefined 5</div></pre></td></tr></table></figure></p>
<p>同样的例子：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">function fetch(url, &#123; body = &apos;&apos;, method = &apos;GET&apos;, headers = &#123;&#125; &#125;) &#123;</div><div class="line">  console.log(method);</div><div class="line">&#125;</div><div class="line"></div><div class="line">fetch(&apos;http://example.com&apos;, &#123;&#125;)</div><div class="line">// &quot;GET&quot;</div><div class="line"></div><div class="line">fetch(&apos;http://example.com&apos;)</div><div class="line">// 报错</div></pre></td></tr></table></figure></p>
<p>避免这种报错，应该写成以下格式：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">function fetch(url, &#123; body = &apos;&apos;, method = &apos;GET&apos;, headers = &#123;&#125; &#125; = &#123;&#125;) &#123;</div><div class="line">  console.log(method);</div><div class="line">&#125;</div><div class="line"></div><div class="line">fetch(&apos;http://example.com&apos;)</div><div class="line">// &quot;GET&quot;</div></pre></td></tr></table></figure></p>
<p>下面看两个很相近的例子：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">// 写法一</div><div class="line">function m1(&#123;x = 0, y = 0&#125; = &#123;&#125;) &#123;</div><div class="line">  return [x, y];</div><div class="line">&#125;</div><div class="line"></div><div class="line">// 写法二</div><div class="line">function m2(&#123;x, y&#125; = &#123; x: 0, y: 0 &#125;) &#123;</div><div class="line">  return [x, y];</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>上面两种写法都对函数的参数设定了默认值，区别是写法一函数参数的默认值是空对象，但是设置了对象解构赋值的默认值（就算不传参数，也会默认解构这个默认参数的赋值）；写法二函数参数的默认值是一个有具体属性的对象，但是没有设置对象解构赋值的默认值，即在以下几种赋值情况下得到的结果为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">// 函数没有参数的情况</div><div class="line">m1() // [0, 0]</div><div class="line">m2() // [0, 0]</div><div class="line"></div><div class="line">// x 和 y 都有值的情况</div><div class="line">m1(&#123;x: 3, y: 8&#125;) // [3, 8]</div><div class="line">m2(&#123;x: 3, y: 8&#125;) // [3, 8]</div><div class="line"></div><div class="line">// x 有值，y 无值的情况</div><div class="line">m1(&#123;x: 3&#125;) // [3, 0]</div><div class="line">m2(&#123;x: 3&#125;) // [3, undefined]</div><div class="line"></div><div class="line">// x 和 y 都无值的情况</div><div class="line">m1(&#123;&#125;) // [0, 0];</div><div class="line">m2(&#123;&#125;) // [undefined, undefined]</div><div class="line"></div><div class="line">m1(&#123;z: 3&#125;) // [0, 0]</div><div class="line">m2(&#123;z: 3&#125;) // [undefined, undefined]</div></pre></td></tr></table></figure></p>
<p>3、函数的    <code>length</code>属性<br>当函数指定了默认值以后，函数的<code>length</code>属性将返回没有被指定默认值的参数个数,即：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">(function (a) &#123;&#125;).length // 1</div><div class="line">(function (a = 5) &#123;&#125;).length // 0</div><div class="line">(function (a, b, c = 5) &#123;&#125;).length // 2</div></pre></td></tr></table></figure></p>
<p>如果设置了默认值的参数不是尾参数，那么函数的<code>length</code>值就是其之前未指定默认值的参数个数，即：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">(function (a = 0, b, c) &#123;&#125;).length // 0</div><div class="line">(function (a, b = 1, c) &#123;&#125;).length // 1</div></pre></td></tr></table></figure></p>
<p>4、设置默认值后函数的作用域<br>一旦设置了参数的默认值，函数进行声明初始化时，参数会形成一个单独的作用域。等到初始化结束，这个作用域就会消失。这种语法行为，在不设置参数默认值时，是不会出现的，例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">var x = 1;</div><div class="line"></div><div class="line">function f(x, y = x) &#123;</div><div class="line">  console.log(y);</div><div class="line">&#125;</div><div class="line"></div><div class="line">f(2) // 2</div></pre></td></tr></table></figure></p>
<p>如果<code>f</code>函数只有一个参数<code>y=x</code>的话，参数形成的单独的作用域中<code>x</code>就指向的是全局变量，得到的结果就是1，例如下面以函数作为参数,其道理相同：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">let foo = &apos;outer&apos;;</div><div class="line"></div><div class="line">function bar(func = () =&gt; foo) &#123;</div><div class="line">  let foo = &apos;inner&apos;;</div><div class="line">  console.log(func());</div><div class="line">&#125;</div><div class="line"></div><div class="line">bar(); // outer</div></pre></td></tr></table></figure></p>
<p>函数<code>bar</code>的参数默认值是一个匿名函数，返回值为变量<code>foo</code>。在函数参数形成的单独作用域里，并没有定义变量，所以<code>foo</code>指向全局变量，因此输出的就是<code>outer</code>，如果此时没有全局变量<code>foo</code>的话就会报错。来看一个终极例子：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">var x = 1;</div><div class="line">function foo(x, y = function() &#123; x = 2; &#125;) &#123;</div><div class="line">  var x = 3;</div><div class="line">  y();</div><div class="line">  console.log(x);</div><div class="line">&#125;</div><div class="line"></div><div class="line">foo() // 3</div><div class="line">x // 1</div></pre></td></tr></table></figure></p>
<p><code>foo</code>函数的参数会形成一个单独的作用域，即：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">var x;</div><div class="line">var y = function()&#123;</div><div class="line">	x = 2;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>再到函数里面又定义了一个变量<code>x</code>，<code>y</code>的默认值是一个匿名函数，这个匿名函数内部的变量<code>x</code>指向的就是参数作用域内变量<code>x</code>，参数变量声明时其值等于全局变量为1，但是函数的第二个参数匿名函数内部将其赋值为2（内部作用域优先级较高），函数内部又声明了一个内部变量<code>x</code>    ,该变量和参数的变量<code>x</code>不是同一个作用域，所以执行<code>y</code>后，内部变量<code>x</code>和外部变量<code>x</code>都没有改变，函数体内的作用域比参数形成的作用域优先级要高，因此，<code>x</code>就是函数体内的值，执行函数打印出的变量值即为最小作用域内的<code>`x</code>的值，虽然函数体内执行了<code>y()</code>，但是<code>y()</code>参数的作用域内的<code>x</code>值没有函数体内的赋值优先级高，因此执行<code>foo()</code>后得到的结果还是最小作用域的值，为3。（尼玛，绕晕了）。<br>下面是另外一种情况：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">var x = 1;</div><div class="line">function foo(x, y = function() &#123; x = 2; &#125;) &#123;</div><div class="line">  x = 3;</div><div class="line">  y();</div><div class="line">  console.log(x);</div><div class="line">&#125;</div><div class="line"></div><div class="line">foo() // 2</div><div class="line">x // 1</div></pre></td></tr></table></figure></p>
<p>因此，如果将<code>var x= 3</code>的<code>var</code>去掉，函数内部没有重新定义变量<code>x</code>，只有将其赋值，也就是在上一个作用域内定义了变量，并且赋值了（类似于函数内定义变量不<code>var</code>的话就是定义了一个全局变量），因此执行<code>foo()</code>函数时，首先没找到函数内部定义的变量<code>x</code>，往上一级（参数作用域内）找，找到了，并且在执行<code>y()</code>的将其重新赋值为2，因此执行<code>foo()</code>函数时打印出的<code>x</code>的值为2。</p>
<p>5、<code>rest</code>参数<br>函数的<code>rest</code>参数形式为（…values）,就不需要<code>arguments</code>对象了，利用这个参数可以给函数传入任意数目的参数。因为<code>arguments</code>对象不是数组，而是一个类似数组的对象。所以为了使用数组的方法，必须使用<code>Array.prototype.slice.call</code>先将其转为数组。<code>rest</code>参数就不存在这个问题，它就是一个真正的数组，数组特有的方法都可以使用。<br><code>rest</code>参数之后不可以再有其他的参数，之前可以有，函数的<code>length</code>属性也不包括<code>rest</code>参数的，只包括其之前的参数。</p>
<p>6、箭头函数<br>最基本的箭头函数如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">var f = v =&gt; v;</div><div class="line">//多行代码需要使用大括号将代码块括起来</div><div class="line"></div><div class="line">//相等于</div><div class="line">var f = function(v) &#123;</div><div class="line">  return v;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>下面看一个使用<code>rest</code>参数结合的箭头函数的返回值<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">const headAndTail = (head, ...tail) =&gt; [head, tail];</div><div class="line"></div><div class="line">headAndTail(1, 2, 3, 4, 5)</div><div class="line">// [1,[2,3,4,5]]</div><div class="line">//因为rest参数是一个数组，所以tail返回的值就是一个数组</div></pre></td></tr></table></figure></p>
<p>值的注意的是，在箭头函数中的<code>this</code>变量就是定义时的对象，而不是调用时所在的那个对象<br>比如说<code>setInterval（() =&gt; {})</code>这个方法中函数里的<code>this</code>就不再是<code>window</code>对象了，而是当前上下文的<code>this</code>对象。<br><code>this</code>指向的固定化，并不是因为箭头函数内部有绑定this的机制，实际原因是箭头函数根本没有自己的<code>this</code>，导致内部的<code>this</code>就是外层代码块的this。正是因为它没有<code>this</code>，所以也就不能用作构造函数。<br>因此，下面代码中虽然层层嵌套了很多的箭头函数，但是却只有一个<code>this</code>,也就是<code>foo()</code>这个函数的<code>this</code>,因此值都为1<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">function foo() &#123;</div><div class="line">  return () =&gt; &#123;</div><div class="line">    return () =&gt; &#123;</div><div class="line">      return () =&gt; &#123;</div><div class="line">        console.log(&apos;id:&apos;, this.id);</div><div class="line">      &#125;;</div><div class="line">    &#125;;</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line">var f = foo.call(&#123;id: 1&#125;);</div><div class="line"></div><div class="line">var t1 = f.call(&#123;id: 2&#125;)()(); // id: 1</div><div class="line">var t2 = f().call(&#123;id: 3&#125;)(); // id: 1</div><div class="line">var t3 = f()().call(&#123;id: 4&#125;); // id: 1</div></pre></td></tr></table></figure></p>
<p>7、双冒号运算符<br>函数绑定运算符是并排的两个冒号<code>（::）</code>，双冒号左边是一个对象，右边是一个函数。该运算符会自动将左边的对象，作为上下文环境（即<code>this</code>对象），绑定到右边的函数上面,相当于ES5中<code>apply</code>,<code>call</code>,<code>bind</code>方法。<br>如果左边是空，右边是一个对象的方法，则等于将该方法绑定在该对象上面。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var method = obj::obj.foo;</div><div class="line">// 等同于</div><div class="line">var method = ::obj.foo;</div></pre></td></tr></table></figure></p>
<p>8、尾调用<br>就是指某个函数的最后一步是调用另一个函数。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">function f(x)&#123;</div><div class="line">  return g(x);</div><div class="line">&#125;</div><div class="line">//或者</div><div class="line">function f(x) &#123;</div><div class="line">  if (x &gt; 0) &#123;</div><div class="line">    return m(x)</div><div class="line">  &#125;</div><div class="line">  return n(x);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>值的注意的是，以下三种情况并不属于尾调用的范畴：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">// 情况一</div><div class="line">function f(x)&#123;</div><div class="line">  let y = g(x);</div><div class="line">  return y;</div><div class="line">&#125;</div><div class="line">//因为调用后还有赋值</div><div class="line"></div><div class="line">// 情况二</div><div class="line">function f(x)&#123;</div><div class="line">  return g(x) + 1;</div><div class="line">&#125;</div><div class="line">//调用后还有操作</div><div class="line"></div><div class="line">// 情况三</div><div class="line">function f(x)&#123;</div><div class="line">  g(x);</div><div class="line">&#125;</div><div class="line">//其实最后一句是return undefined</div></pre></td></tr></table></figure></p>

      
    </div>

    <div>
      
        
      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/ES/" rel="tag">#-ES</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/10/22/20171022-ES6字符串和数值的扩展/" rel="next" title="ES6字符串和数值的扩展">
                <i class="fa fa-chevron-left"></i> ES6字符串和数值的扩展
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="http://obkwv73yp.bkt.clouddn.com/huge.png"
               alt="袁媛" />
          <p class="site-author-name" itemprop="name">袁媛</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">12</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">11</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <p class="post-toc-empty">此文章未包含目录</p>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">袁媛</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.1"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  



  




  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
       search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();

    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
            // get the contents from search data
            isfetched = true;
            $('.popup').detach().appendTo('.header-inner');
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var matchcounts = 0;
                var str='<ul class=\"search-result-list\">';                
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length > 1) {
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = true;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = data.url;
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '' && data_content != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title < 0 && index_content < 0 ){
                                isMatch = false;
                            } else {
                                if (index_content < 0) {
                                    index_content = 0;
                                }
                                if (i == 0) {
                                    first_occur = index_content;
                                }
                            }
                        });
                    }
                    // show search results
                    if (isMatch) {
                        matchcounts += 1;
                        str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out 100 characters
                            var start = first_occur - 20;
                            var end = first_occur + 80;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 50;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substring(start, end);
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                            });
                            
                            str += "<p class=\"search-result\">" + match_content +"...</p>"
                        }
                        str += "</li>";
                    }
                })};
                str += "</ul>";
                if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
                if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
                $resultContent.innerHTML = str;
            });
            proceedsearch();
        }
    });}

    // handle and trigger popup window;
    $('.popup-trigger').mousedown(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };

    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>

  

  

  

</body>
</html>
